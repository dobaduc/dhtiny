<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>DHDrag - Drag &amp; drop management module - DHTiny API &amp; guide</title><link rel="stylesheet" type="text/css" href="../../styles/main.css"><script language=JavaScript src="../../javascript/main.js"></script><script language=JavaScript src="../../javascript/prettify.js"></script><script language=JavaScript src="../../../dhtiny.js"></script><script language=JavaScript src="../../javascript/dhtiny4d.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad();prettyPrint();"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version 1.51 -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org -->




<div id=Content><div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle><a name="DHDrag-Dragdrop_management_module"></a>DHDrag - Drag &amp; drop management module</h1><div class=CBody><p><b>Author</b>:   Do Ba Duc</p><p><b>Implemented</b>: <a href="event-js.html#DHEvent" class=LClass >DHEvent</a></p><h4 class=CHeading><b>Usage</b></h4><blockquote><pre class="prettyprint">$dhtiny.Require(&quot;util/dragmanager&quot;);</pre></blockquote><!--START_ND_SUMMARY--><div class=Summary><div class=STitle>Summary</div><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable><tr class="SMain"><td class=SEntry><a href="#DHDrag-Dragdrop_management_module" >DHDrag - Drag &amp; drop management module</a></td><td class=SDescription><b>Author</b>:   Do Ba Duc</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Introduction" >Introduction</a></td><td class=SDescription>DHDrag make it easy to drag &amp; drop elements. </td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Properties" >Properties</a></td><td class=SDescription></td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#activeObj" >activeObj</a></td><td class=SDescription>Currently being dragged object</td></tr><tr class="SVariable SIndent2"><td class=SEntry><a href="#dragMask" >dragMask</a></td><td class=SDescription>The mask will be used to cover target object</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Methods" >Methods</a></td><td class=SDescription></td></tr><tr class="SVariable SIndent2 SMarked"><td class=SEntry><a href="#canvas" >canvas</a></td><td class=SDescription>A HTMLElement used in this class as the main object</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#setDrag" id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">setDrag</a></td><td class=SDescription>Enable drag&amp;drop and set parameters for an object</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#setDragParams" id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">setDragParams</a></td><td class=SDescription>Change current drag&amp; drop parameters for an object</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#setDrag" >setDrag</a></td><td class=SDescription>Enable drag&amp;drop on an object</td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#setDrag" >setDrag</a></td><td class=SDescription>Disable drag&amp;drop on an object</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#setDragTarget" id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">setDragTarget</a></td><td class=SDescription>Set the drag target for an object. </td></tr><tr class="SFunction SIndent2 SMarked"><td class=SEntry><a href="#addMode" id=link4 onMouseOver="ShowTip(event, 'tt4', 'link4')" onMouseOut="HideTip('tt4')">addMode</a></td><td class=SDescription>Add an user defined drag &amp; drop mode</td></tr><tr class="SFunction SIndent2"><td class=SEntry><a href="#hasDragMode" id=link5 onMouseOver="ShowTip(event, 'tt5', 'link5')" onMouseOut="HideTip('tt5')">hasDragMode</a></td><td class=SDescription>Check if an object is using a specific drag mode or not</td></tr><tr class="SGroup SIndent1"><td class=SEntry><a href="#Built_in_drag_modes" >Built in drag modes</a></td><td class=SDescription>This drag mode allow drag &amp; drop to change object&rsquo;s position. </td></tr></table></div></div><!--END_ND_SUMMARY--></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Introduction"></a>Introduction</h3><div class=CBody><p>DHDrag make it easy to drag &amp; drop elements.&nbsp; It&rsquo;s now supporting very basic effects, but extensible and customizable.&nbsp; You can call this module through <b>DHDrag</b> or $dh.dragger object.</p><h4 class=CHeading>Inherited classes</h4><p><a href="event-js.html#DHEvent" class=LClass >DHEvent</a></p></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Properties"></a>Properties</h3></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="activeObj"></a>activeObj</h3><div class=CBody><p>Currently being dragged object</p></div></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="dragMask"></a>dragMask</h3><div class=CBody><p>The mask will be used to cover target object</p></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Methods"></a>Methods</h3></div></div>

<div class="CVariable"><div class=CTopic><h3 class=CTitle><a name="canvas"></a>canvas</h3><div class=CBody><p>A HTMLElement used in this class as the main object</p></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="setDrag"></a>setDrag</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>setDrag: function(</td><td class="PParameter  prettyprint " nowrap>obj,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>dragParams</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote><p>Enable drag&amp;drop and set parameters for an object</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>obj</td><td class=CDLDescription>Target object</td></tr><tr><td class=CDLEntry>dragParams</td><td class=CDLDescription>Parameter set.</td></tr></table><h4 class=CHeading>NOTE</h4><p>Available properties that can be set through <b>dragParams</b> are:</p><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>mode</td><td class=CDLDescription>Drag mode that will be applied.&nbsp; DHTiny has 2 default drag mode: &ldquo;MOVE&rdquo; and &ldquo;RESIZE&rdquo;</td></tr><tr><td class=CDLEntry>dragOrigin</td><td class=CDLDescription>The object that will be treated as original coordinate when calculating object position.&nbsp; Specifying this is important to prevent miscalculating scrollbars&rsquo; position.</td></tr><tr><td class=CDLEntry>ghostDrag</td><td class=CDLDescription>Use a mask instead of real object while dragging (true/false)</td></tr><tr><td class=CDLEntry>maskStyle</td><td class=CDLDescription>If ghostDrag is enabled, the mask&rsquo;s style will be specified by this property</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="setDragParams"></a>setDragParams</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>setDragParams: function(</td><td class="PParameter  prettyprint " nowrap>obj,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>dragParams</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote><p>Change current drag&amp; drop parameters for an object</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>obj</td><td class=CDLDescription>Target object</td></tr><tr><td class=CDLEntry>dragParams</td><td class=CDLDescription>New drag&amp; drop parameters for obj</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="setDrag"></a>setDrag</h3><div class=CBody><p>Enable drag&amp;drop on an object</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>obj</td><td class=CDLDescription>Target object</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="setDrag"></a>setDrag</h3><div class=CBody><p>Disable drag&amp;drop on an object</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>obj</td><td class=CDLDescription>Target object</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="setDragTarget"></a>setDragTarget</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>setDragTarget: function(</td><td class="PParameter  prettyprint " nowrap>src,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>tar</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote><p>Set the drag target for an object.&nbsp; Drag target is the object whose properties (position, size, ...) will be affected directly while drag &amp; drop the source object.</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>obj</td><td class=CDLDescription>Given object</td></tr><tr><td class=CDLEntry>tar</td><td class=CDLDescription>Target object</td></tr></table></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="addMode"></a>addMode</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>addMode: function(</td><td class="PParameter  prettyprint " nowrap>name,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>modeObj</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote><p>Add an user defined drag &amp; drop mode</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>name</td><td class=CDLDescription>Mode name</td></tr><tr><td class=CDLEntry>modeObj</td><td class=CDLDescription>The user defined object which contains required methods</td></tr></table><p>NOTE: Format of a drag mode User can define following custom methods:</p><ul><li>onDragStart</li><li>onDragStop</li><li>onDragging</li><li>onInitDrag</li></ul><h4 class=CHeading>Example</h4><blockquote><pre class="prettyprint">// Define drag effects
 $dh.dragger.addMode(&quot;MOVE&quot;, {
  onInitDrag: function(sender, target) {
      var pp = [&quot;left&quot;, &quot;top&quot;];
      for (var i = 0; i &lt; pp.length; i++) {
          target.dragParams[&quot;min&quot; + pp[i]] = target.dragParams[&quot;min&quot; + pp[i]] || -99999;
          target.dragParams[&quot;max&quot; + pp[i]] = target.dragParams[&quot;max&quot; + pp[i]] || 99999;
      }
  },
  onDragStart: function(sender, target, ev) {
      if (document.body.style.cursor.indexOf(&quot;resize&quot;) &gt; 0)
          return false;
      $dh.dragger.mouseOffset = $dh.dragger.msOffset(ev, target);
      if (target.dragParams.noMask != true) {
        $dh.dragger.mask.style.cursor = &quot;move&quot;;
        $dh.dragger.mask.style.display = &quot;&quot;;
    }
    var size = $dh.size(target);
    $dh.size($dh.dragger.mask, [size.width, size.height]);
  },

  onDragStop: function(sender, target, ev) {
      target.style.display = &quot;&quot;;
      if (target.dragParams.ghostDrag == true)
          $dh.css(target, {left: $dh.dragger.mask.style.left, top: $dh.dragger.mask.style.top});
      $dh.dragger.mask.style.display = &quot;none&quot;;
  },

  onDragging: function(sender, target, ev) {
      if (document.body.style.cursor.indexOf(&quot;resize&quot;) &gt; 0)
          return false;
      var mousePos = ev.pos;
      var dx = 0, dy = 0;
      if (this.activeObj.dragParams.dragOrigin) {
          dx = -$dh.pos(target.dragParams.dragOrigin).left + target.dragParams.dragOrigin.scrollLeft;
          dy = -$dh.pos(target.dragParams.dragOrigin).top +  target.dragParams.dragOrigin.scrollTop;
      }

      var newPos = {};
      newPos.left = mousePos.left + dx - $dh.dragger.mouseOffset.left;
      newPos.top  = mousePos.top  + dy - $dh.dragger.mouseOffset.top;
      for (var p in newPos) {
          if (newPos[p] &gt; target.dragParams[&quot;max&quot;+p]) newPos[p] = target.dragParams[&quot;max&quot;+p];
          if (newPos[p] &lt; target.dragParams[&quot;min&quot;+p]) newPos[p] = target.dragParams[&quot;min&quot;+p];
      }
    $dh.pos($dh.dragger.mask,[newPos.left, newPos.top]);
    if (target.dragParams.ghostDrag != true)
        $dh.pos(target, [newPos.left, newPos.top]);
  }
 });</pre></blockquote></div></div></div>

<div class="CFunction"><div class=CTopic><h3 class=CTitle><a name="hasDragMode"></a>hasDragMode</h3><div class=CBody><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>hasDragMode: function(</td><td class="PParameter  prettyprint " nowrap>obj,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>mode</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote><h4 class=CHeading>Parameters</h4><p>Check if an object is using a specific drag mode or not</p><h4 class=CHeading>Parameters</h4><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>obj</td><td class=CDLDescription>Object</td></tr><tr><td class=CDLEntry>mode</td><td class=CDLDescription>Drag mode</td></tr></table></div></div></div>

<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="Built_in_drag_modes"></a>Built in drag modes</h3><div class=CBody><h4 class=CHeading>MOVE</h4><p>This drag mode allow drag &amp; drop to change object&rsquo;s position.&nbsp; Available customizable properties are: minleft, maxleft, mintop, maxtop</p><h4 class=CHeading>RESIZE</h4><p>This drag mode allow drag &amp; drop to change object&rsquo;s size.&nbsp; Available customizable properties are: minwidth, maxwidth, minheight, maxheight</p></div></div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>setDrag: function(</td><td class="PParameter  prettyprint " nowrap>obj,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>dragParams</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote>Enable drag&amp;drop and set parameters for an object</div></div><div class=CToolTip id="tt2"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>setDragParams: function(</td><td class="PParameter  prettyprint " nowrap>obj,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>dragParams</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote>Change current drag&amp; drop parameters for an object</div></div><div class=CToolTip id="tt3"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>setDragTarget: function(</td><td class="PParameter  prettyprint " nowrap>src,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>tar</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote>Set the drag target for an object. </div></div><div class=CToolTip id="tt4"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>addMode: function(</td><td class="PParameter  prettyprint " nowrap>name,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>modeObj</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote>Add an user defined drag &amp; drop mode</div></div><div class=CToolTip id="tt5"><div class=CFunction><blockquote><table border=0 cellspacing=0 cellpadding=0 class="Prototype"><tr><td><table border=0 cellspacing=0 cellpadding=0><tr><td class="PBeforeParameters  prettyprint "nowrap>hasDragMode: function(</td><td class="PParameter  prettyprint " nowrap>obj,</td></tr><tr><td></td><td class="PParameter  prettyprint " nowrap>mode</td><td class="PAfterParameters  prettyprint "nowrap>)</td></tr></table></td></tr></table></blockquote>Check if an object is using a specific drag mode or not</div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>